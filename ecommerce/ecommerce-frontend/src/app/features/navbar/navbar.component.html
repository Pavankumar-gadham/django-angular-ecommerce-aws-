<nav class="navbar navbar-expand-lg navbar-dark bg-dark px-3 px-lg-4">
  <a class="navbar-brand me-2" routerLink="/">MyShop</a>

  <!-- Toggler / hamburger -->
  <button
    class="navbar-toggler"
    type="button"
    data-bs-toggle="collapse"
    data-bs-target="#mainNavbar"
    aria-controls="mainNavbar"
    aria-expanded="false"
    aria-label="Toggle navigation"
  >
    <span class="navbar-toggler-icon"></span>
  </button>

  <!-- Collapsible content -->
  <div class="collapse navbar-collapse" id="mainNavbar">
    <ul class="navbar-nav me-auto mb-2 mb-lg-0 align-items-lg-center">
      <li class="nav-item">
        <a class="nav-link" routerLink="/">Home</a>
      </li>
      <li class="nav-item">
        <a class="nav-link" routerLink="/products">All Products</a>
      </li>

      <!-- Category Dropdown (works on desktop; on small screens it's full-width and scrollable) -->
      <li class="nav-item dropdown" ngbDropdown>
        <button
          class="nav-link dropdown-toggle btn btn-link p-0"
          type="button"
          ngbDropdownToggle
          id="categoriesDropdown"
          aria-expanded="false"
        >
          Categories
        </button>

        <ul class="dropdown-menu p-3 categories-menu" ngbDropdownMenu aria-labelledby="categoriesDropdown">
          <li *ngFor="let category of categories">
            <div class="form-check touch-friendly">
              <input
                class="form-check-input"
                type="checkbox"
                [value]="category.name"
                (change)="onCategorySelect(category, $event)"
                [checked]="selectedCategories.includes(category.name)"
                id="cat-{{category.id}}"
              />
              <label class="form-check-label" for="cat-{{category.id}}">
                {{ category.name }}
              </label>
            </div>
          </li>
        </ul>
      </li>

      <!-- Authenticated user links -->
      <ng-container *ngIf="isAuthenticated; else guestLinks">
        <li class="nav-item">
          <a class="nav-link" routerLink="/cart">Cart</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/orders">Orders</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/user/profile">Profile</a>
        </li>
      </ng-container>

      <!-- Guest links -->
      <ng-template #guestLinks>
        <li class="nav-item">
          <a class="nav-link" routerLink="/cart">Cart</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/auth/login">Login</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" routerLink="/auth/register">Register</a>
        </li>
      </ng-template>
    </ul>

    <!-- Logout: moved inside collapse so accessible on mobile. Will show only if authenticated -->
    <div class="d-flex align-items-center">
      <button
        *ngIf="isAuthenticated"
        class="btn btn-outline-light btn-sm logout-btn"
        (click)="logout()"
      >
        Logout
      </button>
    </div>
  </div>
</nav>
