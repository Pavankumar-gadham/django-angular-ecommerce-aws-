"use strict";(self.webpackChunkecommerce_frontend=self.webpackChunkecommerce_frontend||[]).push([[246],{4246:(O,p,d)=>{d.r(p),d.d(p,{OrdersModule:()=>I});var c=d(177),u=d(749),e=d(8699),g=d(8065),F=d(5312),m=d(1626);let h=(()=>{class n{constructor(t){this.http=t,this.baseUrl=`${F.c.apiUrl}/orders/`}createOrder(t){const r={Authorization:`Bearer ${localStorage.getItem("access_token")}`};return this.http.post(this.baseUrl,t,{headers:r})}getMyOrders(t){const r={Authorization:`Bearer ${localStorage.getItem("access_token")}`};let i={};return t&&"all"!==t&&(i.date_filter=t),this.http.get(this.baseUrl,{headers:r,params:i})}static{this.\u0275fac=function(o){return new(o||n)(e.KVO(m.Qq))}}static{this.\u0275prov=e.jDH({token:n,factory:n.\u0275fac,providedIn:"root"})}}return n})();var a=d(4341);function C(n,l){if(1&n&&(e.j41(0,"tr")(1,"td"),e.EFF(2),e.k0s(),e.j41(3,"td"),e.EFF(4),e.k0s(),e.j41(5,"td"),e.EFF(6),e.k0s(),e.j41(7,"td"),e.EFF(8),e.k0s()()),2&n){const t=l.$implicit;e.R7$(2),e.JRh(t.name),e.R7$(2),e.JRh(t.quantity),e.R7$(2),e.SpI("\u20b9",t.price,""),e.R7$(2),e.SpI("\u20b9",t.price*t.quantity,"")}}function f(n,l){if(1&n){const t=e.RV6();e.j41(0,"div")(1,"table",15)(2,"thead")(3,"tr")(4,"th"),e.EFF(5,"Product"),e.k0s(),e.j41(6,"th"),e.EFF(7,"Qty"),e.k0s(),e.j41(8,"th"),e.EFF(9,"Price"),e.k0s(),e.j41(10,"th"),e.EFF(11,"Total"),e.k0s()()(),e.j41(12,"tbody"),e.DNE(13,C,9,4,"tr",16),e.k0s()(),e.j41(14,"h4"),e.EFF(15),e.k0s(),e.j41(16,"button",17),e.bIt("click",function(){e.eBV(t);const r=e.XpG();return e.Njj(r.placeOrder())}),e.EFF(17),e.k0s()()}if(2&n){const t=e.XpG();e.R7$(13),e.Y8G("ngForOf",t.cartItems),e.R7$(2),e.SpI("Total: \u20b9",t.totalAmount,""),e.R7$(1),e.Y8G("disabled",t.loading),e.R7$(1),e.SpI(" ",t.loading?"Placing order...":"Place Order"," ")}}function _(n,l){1&n&&(e.j41(0,"p"),e.EFF(1,"Your cart is empty. "),e.j41(2,"a",18),e.EFF(3,"Shop Now"),e.k0s()())}function M(n,l){1&n&&(e.j41(0,"div",9),e.EFF(1," No orders found for selected period. "),e.k0s())}function v(n,l){if(1&n&&(e.j41(0,"div",12),e.nrm(1,"img",13),e.j41(2,"div")(3,"p",14)(4,"strong"),e.EFF(5),e.k0s()(),e.j41(6,"p",15),e.EFF(7),e.k0s()()()),2&n){const t=l.$implicit;e.R7$(1),e.FS9("alt",t.product.name),e.Y8G("src",t.product.image,e.B4B),e.R7$(4),e.JRh(t.product.name),e.R7$(2),e.Lme(" Qty: ",t.quantity," \xa0|\xa0 \u20b9",t.price," ")}}function y(n,l){if(1&n&&(e.j41(0,"div",10)(1,"h5"),e.EFF(2),e.k0s(),e.j41(3,"p"),e.EFF(4),e.k0s(),e.j41(5,"p"),e.EFF(6),e.nI1(7,"date"),e.k0s(),e.DNE(8,v,8,5,"div",11),e.k0s()),2&n){const t=l.$implicit;e.R7$(2),e.SpI("Order #",t.id,""),e.R7$(2),e.SpI("Total Price: \u20b9",t.total_price,""),e.R7$(2),e.SpI("Placed On: ",e.i5U(7,4,t.created_at,"medium"),""),e.R7$(2),e.Y8G("ngForOf",t.items)}}const j=[{path:"checkout",component:(()=>{class n{constructor(t,o,r){this.cartService=t,this.orderService=o,this.router=r,this.cartItems=[],this.totalAmount=0,this.loading=!1,this.address={full_name:"",phone:"",address_line:"",city:"",state:"",pincode:""}}ngOnInit(){this.cartItems=this.cartService.getCart(),this.totalAmount=this.cartItems.reduce((t,o)=>t+o.price*o.quantity,0)}placeOrder(){if(0===this.cartItems.length)return void alert("Your cart is empty!");const t={order_items:this.cartItems.map(o=>({product_id:o.id,quantity:o.quantity})),shipping_address:this.address};this.loading=!0,this.orderService.createOrder(t).subscribe({next:()=>{this.loading=!1,alert("Order placed successfully!"),this.cartService.clearCart(),this.router.navigate(["/orders"])},error:o=>{this.loading=!1,console.error(o),alert("Please provide your address to place order!")}})}static{this.\u0275fac=function(o){return new(o||n)(e.rXU(g.m),e.rXU(h),e.rXU(u.Ix))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-checkout"]],decls:35,vars:8,consts:[[1,"container","mt-4"],["addressForm","ngForm"],[1,"mt-3"],[1,"row"],[1,"col-md-6"],["type","text","name","full_name","required","",1,"form-control",3,"ngModel","ngModelChange"],["type","tel","name","phone","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-md-12","mt-2"],["name","address_line","required","",1,"form-control",3,"ngModel","ngModelChange"],[1,"col-md-4","mt-2"],["type","text","name","city","required","",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","state","required","",1,"form-control",3,"ngModel","ngModelChange"],["type","text","name","pincode","required","",1,"form-control",3,"ngModel","ngModelChange"],[4,"ngIf","ngIfElse"],["emptyCart",""],[1,"table","mt-4"],[4,"ngFor","ngForOf"],[1,"btn","btn-success","mt-3",3,"disabled","click"],["routerLink","/products"]],template:function(o,r){if(1&o&&(e.j41(0,"div",0)(1,"h2"),e.EFF(2,"Checkout"),e.k0s(),e.j41(3,"form",null,1)(5,"h4",2),e.EFF(6,"Shipping Address"),e.k0s(),e.j41(7,"div",3)(8,"div",4)(9,"label"),e.EFF(10,"Full Name"),e.k0s(),e.j41(11,"input",5),e.bIt("ngModelChange",function(s){return r.address.full_name=s}),e.k0s()(),e.j41(12,"div",4)(13,"label"),e.EFF(14,"Phone"),e.k0s(),e.j41(15,"input",6),e.bIt("ngModelChange",function(s){return r.address.phone=s}),e.k0s()(),e.j41(16,"div",7)(17,"label"),e.EFF(18,"Address"),e.k0s(),e.j41(19,"textarea",8),e.bIt("ngModelChange",function(s){return r.address.address_line=s}),e.k0s()(),e.j41(20,"div",9)(21,"label"),e.EFF(22,"City"),e.k0s(),e.j41(23,"input",10),e.bIt("ngModelChange",function(s){return r.address.city=s}),e.k0s()(),e.j41(24,"div",9)(25,"label"),e.EFF(26,"State"),e.k0s(),e.j41(27,"input",11),e.bIt("ngModelChange",function(s){return r.address.state=s}),e.k0s()(),e.j41(28,"div",9)(29,"label"),e.EFF(30,"Pincode"),e.k0s(),e.j41(31,"input",12),e.bIt("ngModelChange",function(s){return r.address.pincode=s}),e.k0s()()()(),e.DNE(32,f,18,4,"div",13),e.DNE(33,_,4,0,"ng-template",null,14,e.C5r),e.k0s()),2&o){const i=e.sdS(34);e.R7$(11),e.Y8G("ngModel",r.address.full_name),e.R7$(4),e.Y8G("ngModel",r.address.phone),e.R7$(4),e.Y8G("ngModel",r.address.address_line),e.R7$(4),e.Y8G("ngModel",r.address.city),e.R7$(4),e.Y8G("ngModel",r.address.state),e.R7$(4),e.Y8G("ngModel",r.address.pincode),e.R7$(1),e.Y8G("ngIf",r.cartItems.length>0)("ngIfElse",i)}},dependencies:[c.Sq,c.bT,a.qT,a.me,a.BC,a.cb,a.YS,a.vS,a.cV,u.Wk]})}}return n})()},{path:"",component:(()=>{class n{constructor(t){this.orderService=t,this.orders=[],this.selectedFilter="all"}ngOnInit(){this.loadOrders()}loadOrders(){this.orderService.getMyOrders(this.selectedFilter).subscribe({next:t=>{this.orders=t.results?t.results:t},error:t=>console.error("Failed to load orders",t)})}onFilterChange(t){this.selectedFilter=t,this.loadOrders()}static{this.\u0275fac=function(o){return new(o||n)(e.rXU(h))}}static{this.\u0275cmp=e.VBU({type:n,selectors:[["app-order-list"]],decls:18,vars:6,consts:[[1,"container","mt-4"],[1,"filters","mb-3"],[1,"me-3"],["type","radio","name","dateFilter","value","all",3,"ngModel","ngModelChange","change"],["type","radio","name","dateFilter","value","today",3,"ngModel","ngModelChange","change"],["type","radio","name","dateFilter","value","last7days",3,"ngModel","ngModelChange","change"],["type","radio","name","dateFilter","value","last30days",3,"ngModel","ngModelChange","change"],["class","text-muted",4,"ngIf"],["class","card mb-3 p-3 shadow-sm",4,"ngFor","ngForOf"],[1,"text-muted"],[1,"card","mb-3","p-3","shadow-sm"],["class","d-flex align-items-center mb-2 border-top pt-2",4,"ngFor","ngForOf"],[1,"d-flex","align-items-center","mb-2","border-top","pt-2"],["width","70","height","70",1,"me-3","rounded",3,"src","alt"],[1,"mb-1"],[1,"mb-0","text-muted"]],template:function(o,r){1&o&&(e.j41(0,"div",0)(1,"h3"),e.EFF(2,"Your Orders"),e.k0s(),e.j41(3,"div",1)(4,"label",2)(5,"input",3),e.bIt("ngModelChange",function(s){return r.selectedFilter=s})("change",function(){return r.onFilterChange("all")}),e.k0s(),e.EFF(6," All "),e.k0s(),e.j41(7,"label",2)(8,"input",4),e.bIt("ngModelChange",function(s){return r.selectedFilter=s})("change",function(){return r.onFilterChange("today")}),e.k0s(),e.EFF(9," Today "),e.k0s(),e.j41(10,"label",2)(11,"input",5),e.bIt("ngModelChange",function(s){return r.selectedFilter=s})("change",function(){return r.onFilterChange("last7days")}),e.k0s(),e.EFF(12," Last 7 Days "),e.k0s(),e.j41(13,"label",2)(14,"input",6),e.bIt("ngModelChange",function(s){return r.selectedFilter=s})("change",function(){return r.onFilterChange("last30days")}),e.k0s(),e.EFF(15," Last 30 Days "),e.k0s()(),e.DNE(16,M,2,0,"div",7),e.DNE(17,y,9,7,"div",8),e.k0s()),2&o&&(e.R7$(5),e.Y8G("ngModel",r.selectedFilter),e.R7$(3),e.Y8G("ngModel",r.selectedFilter),e.R7$(3),e.Y8G("ngModel",r.selectedFilter),e.R7$(3),e.Y8G("ngModel",r.selectedFilter),e.R7$(2),e.Y8G("ngIf",0===r.orders.length),e.R7$(1),e.Y8G("ngForOf",r.orders))},dependencies:[c.Sq,c.bT,a.me,a.Fm,a.BC,a.vS,c.vh]})}}return n})()}];let b=(()=>{class n{static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[u.iI.forChild(j),u.iI]})}}return n})(),I=(()=>{class n{static{this.\u0275fac=function(o){return new(o||n)}}static{this.\u0275mod=e.$C({type:n})}static{this.\u0275inj=e.G2t({imports:[c.MD,a.YN,m.q1,b]})}}return n})()}}]);